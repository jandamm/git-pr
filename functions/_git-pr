#compdef git-pr


function _last_refs() {
	_values refs $(git log --format='%h' head...origin/head)
}

function _git-pr() {
	_arguments '1: :->cmd' '2: :->arg1'

	if [[ $state = 'cmd' ]]; then
		_values command 'new' 'update' 'checkout' 'open' 'switch'
	else
		case $line[1] in
			new|update|branch)  _last_refs;;
			open) _values option --no-push -t --title -d --desc --reviewer;;
		esac
	fi
}

_git-pr $@
